<!-- frontend/share.html -->
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Partager - World of Tanks Blitz</title>
  <link rel="stylesheet" href="css/styles.css" />
</head>
<body>
  <header>
    <h1>Partager un contenu</h1>
    <nav>
    <div style="flex-grow: 1;">
     <a href="../index.html">Accueil</a>
      <a href="share.html">Partager</a>
      <a href="search.html"> Recherche</a>
      <a href="donate.html">Faire un don</a>
      <a id="login-logout" href="login.html">Se connecter</a>
    </div>
    <form id="quick-search-form" style="display: flex; gap: 0.5em; align-items: center;">
      <input type="text" id="quick-search" placeholder="üîç Pseudo ou char" style="padding: 0.3em; border-radius: 5px; border: 1px solid #30363d; background-color: #0d1117; color: #c9d1d9;">
      <button type="submit" style="padding: 0.3em 0.6em; background-color: #238636; color: white; border: none; border-radius: 5px;">Go</button>
    </form>
    <span id="auth-link" style="margin-left: 1em;"></span>
  </nav>
  </header>
 <section>
      <h2>Publications r√©centes</h2>
      <div id="posts-container"></div>
 </section>

  <ul id="shared-content-list"></ul>
  <script>
    async function loadSharedContent(){
      const res = await fetch("/api/share");
      const data = await res.json();
      const list = document.getElementById("shared-content-list");
      list.innerHTML = data.length ? "" : "<li>Aucun contenu</li>";
      data.forEach(item => {
        const li = document.createElement("li");
        const date = new Date(item.date).toLocaleString();
        li.innerHTML = `
          <strong>${item.type.toUpperCase()}</strong> - <em>${item.title}</em><br>
          ${item.description}<br>
          <small>Par ${item.author} le ${date}</small>
          ${item.file ? `<br><a href="${item.file}" target="_blank">Voir fichier</a>` : ""}
        `;
        list.appendChild(li);
      });
    }
    document.querySelector("#share-form").addEventListener("submit", async e => {
      e.preventDefault();
      const data = new FormData(e.target);
      await fetch("/api/share", { method: "POST", body: data });
      loadSharedContent();
      e.target.reset();
    });
    window.addEventListener("DOMContentLoaded", loadSharedContent);
  </script>
</body>
</html>