<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Profil - World of Tanks Blitz</title>
  <style>
    :root {
  --charcoal: #1E1E1E;
  --black: #000000;
  --white: #FFFFFF;
  --kaki-dark: #556B2F;
  --kaki: #6B8E23;
  --hover-kaki: #7BA331;
  --kaki-light: #9ACD32;
  --border-color: #333;
  --light-grey: #ccc;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background-color: var(--charcoal);
  color: var(--white);
  line-height: 1.6;
}

header {
  background-color: var(--black);
  padding: 1em 2em;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

nav a {
  color: var(--kaki-light);
  text-decoration: none;
  margin: 0 1em;
  font-weight: bold;
  transition: color 0.3s;
}

nav a:hover {
  color: var(--hover-kaki);
  text-decoration: underline;
}

main {
  padding: 2em;
  max-width: 1000px;
  margin: auto;
}

section {
  background-color: var(--black);
  border: 1px solid var(--kaki-dark);
  border-radius: 10px;
  padding: 1.5em;
  margin-bottom: 2em;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
}

h1, h2, h3 {
  border-bottom: 2px solid var(--kaki);
  margin-bottom: 0.5em;
  padding-bottom: 0.3em;
  color: var(--kaki-light);
}

input, textarea, select {
  width: 100%;
  padding: 0.8em;
  margin-top: 0.5em;
  border-radius: 5px;
  border: 1px solid var(--border-color);
  background-color: var(--charcoal);
  color: var(--white);
}

button {
  background-color: var(--kaki);
  color: var(--white);
  padding: 0.7em 1.5em;
  border: none;
  border-radius: 5px;
  margin-top: 1em;
  cursor: pointer;
  transition: background-color 0.3s;
}

button:hover {
  background-color: var(--hover-kaki);
}

#search-bar {
  display: flex;
  align-items: center;
  gap: 0.5em;
  margin-left: auto;
}

#search-bar input {
  flex: 1;
  max-width: 250px;
}

.card {
  background-color: #2a2a2a;
  padding: 1em;
  border-radius: 8px;
  border: 1px solid var(--kaki-dark);
  margin-bottom: 1em;
}

.footer {
  margin-top: 3em;
  padding: 1em;
  text-align: center;
  background-color: var(--black);
  border-top: 1px solid var(--border-color);
  color: var(--light-grey);
}

/* Zones de résultats ou d'erreurs */
.result, .error {
  margin-top: 1em;
  padding: 1em;
  border-radius: 5px;
}

.result {
  background-color: #263a1f;
  color: var(--white);
}

.error {
  background-color: #5a2a2a;
  color: #ffaaaa;
}
</style> 
</head>
<body>
  <header>
    <h1>Mon Profil</h1>
    <nav>
    <div style="flex-grow: 1;">
      <a href="../index.html">Accueil</a>
      <a href="profile.html">Profil</a>
      <a href="share.html">Partager</a>
      <a href="search.html"> Recherche</a>
      <a href="donate.html">Faire un don</a>
      <a id="login-logout" href="login.html">Se connecter</a>
    </div>
  </nav>
  </header>
   <main class="centered">
    <section class="profile-section">
      <h1>Mon Profil</h1>

      <div id="profile-header">
        <img src="https://via.placeholder.com/100" alt="Avatar" class="avatar" id="avatar" />
        <div>
          <h2 id="player-name">Nom du joueur</h2>
          <p id="player-tank">Le tank préféré : T-34</p>
        </div>
      </div>

      <section class="stats">
        <h2>Statistiques de performance</h2>
        <ul>
          <li><strong>Batailles :</strong> <span id="battles">0</span></li>
          <li><strong>Taux de victoire (30 jours) :</strong> <span id="win-rate">0%</span></li>
          <li><strong>Taux de survie :</strong> <span id="survival-rate">0%</span></li>
          <li><strong>XP moyen :</strong> <span id="avg-xp">0</span></li>
          <li><strong>Max XP :</strong> <span id="max-xp">0</span></li>
          <li><strong>Victoires moyennes / bataille :</strong> <span id="avg-wins-per-battle">0</span></li>
          <li><strong>Nombre moyen de morts / morts :</strong> <span id="avg-deaths-per-battle">0</span></li>
          <li><strong>Points / bataille moyens :</strong> <span id="avg-points-per-battle">0</span></li>
          <li><strong>Dégâts moyens :</strong> <span id="avg-damage">0</span></li>
          <li><strong>Dmg / Shot :</strong> <span id="dmg-per-shot">0</span></li>
          <li><strong>Dmg / Hit :</strong> <span id="dmg-per-hit">0</span></li>
          <li><strong>Capture de la base moyenne :</strong> <span id="base-capture">0%</span></li>
          <li><strong>Défense de la base moyenne :</strong> <span id="base-defense">0%</span></li>
          <li><strong>Dommages accordés / reçus :</strong> <span id="damage-done-received">0%</span></li>
          <li><strong>Taux de succès :</strong> <span id="success-rate">0%</span></li>
          <li><strong>Tanks possédés :</strong> <span id="tanks-owned">0</span></li>
          <li><strong>Insignes de maîtrise (As) :</strong> <span id="mastery-badges">0</span></li>
        </ul>
      </section>

      <section class="replays">
        <h2>Replays récents</h2>
        <ul id="replay-list">
          <!-- Les replays s'affichent ici -->
          <li>Aucun replay disponible.</li>
        </ul>
      </section>

      <section class="tips">
        <h2>Astuces</h2>
        <ul id="tip-list">
          <!-- Les astuces s'affichent ici -->
          <li>Aucune astuce partagée.</li>
        </ul>
      </section>
    </section>
  </main>
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
  // Récupérer le nom du joueur depuis le localStorage
  const playerName = localStorage.getItem('playerName'); 

  if (playerName) {
    document.getElementById('player-name').textContent = playerName;

    // Appeler l'API pour récupérer les statistiques du joueur
    try {
      const response = await fetch(`/api/player/${playerName}`);
      const data = await response.json();

      if (response.ok) {
        // Afficher les statistiques du joueur
        document.getElementById('battles').textContent = data.stats.battles || 0;
        document.getElementById('win-rate').textContent = data.stats.win_rate + '%';
        document.getElementById('survival-rate').textContent = data.stats.survival_rate + '%';
        document.getElementById('avg-xp').textContent = data.stats.avg_xp || 0;
        document.getElementById('max-xp').textContent = data.stats.max_xp || 0;
        document.getElementById('avg-wins-per-battle').textContent = data.stats.avg_wins_per_battle || 0;
        document.getElementById('avg-deaths-per-battle').textContent = data.stats.avg_deaths_per_battle || 0;
        document.getElementById('avg-points-per-battle').textContent = data.stats.avg_points_per_battle || 0;
        document.getElementById('avg-damage').textContent = data.stats.avg_damage || 0;
        document.getElementById('dmg-per-shot').textContent = data.stats.dmg_per_shot || 0;
        document.getElementById('dmg-per-hit').textContent = data.stats.dmg_per_hit || 0;
        document.getElementById('base-capture').textContent = data.stats.base_capture || 0;
        document.getElementById('base-defense').textContent = data.stats.base_defense || 0;
        document.getElementById('damage-done-received').textContent = data.stats.damage_done_received || 0;
        document.getElementById('success-rate').textContent = data.stats.success_rate + '%';
        document.getElementById('tanks-owned').textContent = data.stats.tanks_owned || 0;
        document.getElementById('mastery-badges').textContent = data.stats.mastery_badges || 0;

        // Afficher l'avatar
        document.getElementById('avatar').src = data.avatar_url;

        // Replays de l'utilisateur
        const replayList = document.getElementById('replay-list');
        if (data.replays.length > 0) {
          data.replays.forEach(replay => {
            const li = document.createElement('li');
            li.textContent = replay.title;  // Assurez-vous que chaque objet 'replay' possède une propriété 'title'
            replayList.appendChild(li);
          });
        } else {
          replayList.innerHTML = '<li>Aucun replay disponible.</li>';
        }

        // Astuces de l'utilisateur
        const tipList = document.getElementById('tip-list');
        if (data.tips.length > 0) {
          data.tips.forEach(tip => {
            const li = document.createElement('li');
            li.textContent = tip.title; // Assurez-vous que chaque objet 'tip' possède une propriété 'title'
            tipList.appendChild(li);
          });
        } else {
          tipList.innerHTML = '<li>Aucune astuce partagée.</li>';
        }
      } else {
        alert('Erreur de récupération des données');
      }
    } catch (error) {
      console.error('Erreur:', error);
      alert('Erreur lors de la récupération des données');
    }
  } else {
    alert('Utilisateur non trouvé');
  }
});
  </script>
</body>
</html>
